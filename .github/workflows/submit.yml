name: Form Submission Bot

on:
  # Allows the workflow to be manually triggered from the GitHub Actions tab
  workflow_dispatch:
    inputs:
      start_row:
        description: 'Start submission from this row number (0-indexed). E.g., if it failed after 500, enter 500.'
        required: false
        default: '0'

jobs:
  submit_form_data:
    # Use the default Linux runner
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.x'

    - name: Install dependencies
      # Install the required libraries (requests and pandas)
      run: |
        python -m pip install --upgrade pip
        pip install requests pandas

    - name: Run Submission Bot
      # The bot.py script handles both CSV generation (if needed) and submission.
      # We pass the user-provided start_row as the first command line argument to bot.py
      run: |
        echo "Starting submission with bot.py from row ${{ github.event.inputs.start_row }}"
        python bot.py ${{ github.event.inputs.start_row }}
